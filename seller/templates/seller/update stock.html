{% extends 'seller/master_seller.html' %}
{% load static %}

{% block title %}
<title>Update Stock</title>
{% endblock %}

{% block content %}
<h1
    style="text-align: center; color: rgb(50, 91, 134); font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;font-size: 30px;margin-top: 20px;">
    <u>UPDATE STOCK</u>
</h1><br>
<div class="container"
    style="background-color: rgb(147, 186, 228); font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;height: 350px; width: 400px;border-radius: 10px;">
    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="mb-3">
            <label for="exampleFormControlTextarea1" class="form-label">Product No</label>
            <select   name="p_number" id="product" class="form-control" data-bs-toggle="dropdown" aria-expanded="false">
                {% for product in products %}
                <option value="{{product.id}}">{{ product.p_name | title }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="mb-3">
            <label for="exampleFormControlInput1" class="form-label">Current Stock</label>
            <input type="text" class="form-control" id="stock_field" name="p_category" >
        </div>
        <div class="mb-3">
            <label for="exampleFormControlInput1" class="form-label">New Stock</label>
            <input type="number" class="form-control" id="categoryField" name="new_stock" min="1">
        </div>
        <button type="submit" class="btn btn-danger">Update</button>
    </form>
</div>
<script>

    $(document).ready(function () {
        $.ajaxSetup({
            headers: {
                "X-CSRFToken": $('[name=csrfmiddlewaretoken]').val()
            }
        })

        $('#product').change(function(){

            $.ajax({

                type: 'POST',
                url: "{% url 'seller:stock_update' %}",
                data: {
                    'product_id': $(this).val()
                },


                success: function(response){

                    let res = response.stock
                    $('#stock_field').val(res)
                }
            })
        })
    })

</script>
{% endblock %}